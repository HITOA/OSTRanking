
<div class="flex gap-x-8 mx-auto lg:py-0 container text-black dark:text-white">
    <div id="request_list_container" class="mt-20 w-2/3 flex flex-col gap-y-4 items-center lg:py-0 container">
    </div>
    <div class="mt-20 w-1/3 flex flex-col gap-y-4 items-center lg:py-0 container">
    </div>
</div>
<script src="/scripts/moment.min.js"></script>
<script>
    var request_list_container = document.getElementById("request_list_container");

    var request_template = ""

    function addCommunityActionEntry(start, count) {
        getCommunityActions(start, count).then(actions => {
            for (action of actions) {
                console.log(action);
                switch (action.info.type) {
                    case "request": {
                        let relation_type_name = ["Opening", "Ending", "Insert"];
                        let template_data = {
                            show_thumbnail: action.info.content.relations[0].medium,
                            username: action.name,
                            since: moment(action.creation_date).fromNow(),
                            song_name: action.info.content.ost.name,
                            song_show_relation: `${relation_type_name[action.info.content.relations[0].type]} ${action.info.content.relations[0].number}`,
                            show_name: action.info.content.relations[0].preferred
                        }
                        request_list_container.innerHTML += ejs.render(request_template, template_data)
                        break;
                    }
                }
            }
        })
    }

    fetch("/templates/request.ejs").then((res) => {
        res.text().then((template) => {
            request_template = template
            addCommunityActionEntry(0, 10);
        })
    })

</script>